FROM node:22-alpine

WORKDIR /app

# Copy only what we need
COPY packages/aios-lovable-mcp/package*.json ./
COPY packages/aios-lovable-mcp/tsconfig.json ./

# Install dependencies
RUN npm install

# Copy source
COPY packages/aios-lovable-mcp/src ./src

# Build
RUN npm run build

# Copy built files
COPY packages/aios-lovable-mcp/dist ./dist

# Environment
ENV PORT=3000
ENV NODE_ENV=production
ENV MCP_ENABLED=false

# Start
CMD ["node", "dist/start-with-http.js"]
