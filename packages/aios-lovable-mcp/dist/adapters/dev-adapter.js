/**
 * Dev Adapter
 *
 * Translates MCP aios_generate_code requests into @dev agent execution
 * and parses the result back into structured file output.
 *
 * Phase 1 (MVP): Returns scaffold code files based on the spec.
 * In production, this will invoke the actual @dev agent via AIOS.
 */
const TIMEOUT_MS = 10 * 60 * 1000; // 10 minutes
export class DevAdapter {
    async execute(input) {
        const start = Date.now();
        try {
            const result = await this.runAgent(input);
            return {
                success: true,
                data: result,
                duration_ms: Date.now() - start,
            };
        }
        catch (err) {
            const message = err instanceof Error ? err.message : 'Unknown dev agent error';
            return {
                success: false,
                error: {
                    code: 'AGENT_FAILURE',
                    message: `Dev agent failed: ${message}`,
                },
                duration_ms: Date.now() - start,
            };
        }
    }
    async runAgent(input) {
        // Phase 1: Return scaffold code files.
        // The real agent integration replaces this in Phase 2.
        const framework = input.framework ?? 'nextjs-react';
        const isNext = framework.includes('next');
        const files = [];
        if (isNext) {
            files.push({
                path: 'src/app/page.tsx',
                content: [
                    `// Generated by AIOS @dev agent`,
                    `// Spec: ${input.spec.slice(0, 100)}`,
                    ``,
                    `export default function Home() {`,
                    `  return (`,
                    `    <main className="flex min-h-screen flex-col items-center justify-center p-24">`,
                    `      <h1 className="text-4xl font-bold">Welcome</h1>`,
                    `      <p className="mt-4 text-lg text-gray-600">Generated by Synkra AIOS</p>`,
                    `    </main>`,
                    `  );`,
                    `}`,
                ].join('\n'),
                language: 'typescript',
            });
            files.push({
                path: 'src/app/layout.tsx',
                content: [
                    `// Generated by AIOS @dev agent`,
                    `import type { Metadata } from 'next';`,
                    `import './globals.css';`,
                    ``,
                    `export const metadata: Metadata = {`,
                    `  title: 'AIOS Generated App',`,
                    `  description: 'Built with Synkra AIOS + Lovable',`,
                    `};`,
                    ``,
                    `export default function RootLayout({ children }: { children: React.ReactNode }) {`,
                    `  return (`,
                    `    <html lang="en">`,
                    `      <body>{children}</body>`,
                    `    </html>`,
                    `  );`,
                    `}`,
                ].join('\n'),
                language: 'typescript',
            });
        }
        else {
            files.push({
                path: 'src/App.tsx',
                content: [
                    `// Generated by AIOS @dev agent`,
                    `// Spec: ${input.spec.slice(0, 100)}`,
                    ``,
                    `function App() {`,
                    `  return (`,
                    `    <div className="flex min-h-screen flex-col items-center justify-center p-24">`,
                    `      <h1 className="text-4xl font-bold">Welcome</h1>`,
                    `      <p className="mt-4 text-lg text-gray-600">Generated by Synkra AIOS</p>`,
                    `    </div>`,
                    `  );`,
                    `}`,
                    ``,
                    `export default App;`,
                ].join('\n'),
                language: 'typescript',
            });
        }
        return {
            files,
            dependencies: {
                production: {
                    '@supabase/supabase-js': '^2.x',
                    'tailwindcss': '^3.x',
                },
                development: {
                    '@types/node': '^20.x',
                    'typescript': '^5.x',
                },
            },
            setup_instructions: [
                '1. Install dependencies: npm install',
                '2. Configure Supabase: copy .env.example to .env.local',
                '3. Run development server: npm run dev',
            ].join('\n'),
        };
    }
    get timeoutMs() {
        return TIMEOUT_MS;
    }
}
//# sourceMappingURL=dev-adapter.js.map